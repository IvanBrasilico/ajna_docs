

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="pt-BR" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="pt-BR" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>BHADRASANA &mdash; AJNA 0.1a documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="VIRASANA" href="virasana.html" />
    <link rel="prev" title="COMMONS" href="ajna_commons.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> AJNA
          

          
          </a>

          
            
            
              <div class="version">
                0.1a
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="manuais.html">Manuais de Usuário</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="codigofonte.html">Documentação do código-fonte</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ajna_commons.html">COMMONS</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">BHADRASANA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#funcoes">Funções</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-bhadrasana.bhadrasana.utils.csv_handlers">Utilitátios CSV</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-bhadrasana.bhadrasana.utils.gerente_risco">Gerente de Risco</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-bhadrasana.bhadrasana.utils.gerente_base">Gerente de Bases</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bhadrasana.bhadrasana.app">Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modulo-bhadrasana-ajna">Módulo Bhadrasana - AJNA</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bhadrasana.bhadrasana.models.models">Banco de Dados</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="virasana.html">VIRASANA</a></li>
<li class="toctree-l2"><a class="reference internal" href="padma.html">PADMA</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="UserStories.html">Histórias de Usuário</a></li>
<li class="toctree-l1"><a class="reference internal" href="Arquitetura.html">Módulos do Sistema</a></li>
<li class="toctree-l1"><a class="reference internal" href="Arquitetura.html#arquitetura-do-sistema">Arquitetura do Sistema</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AJNA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="codigofonte.html">Documentação do código-fonte</a> &raquo;</li>
        
      <li>BHADRASANA</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/bhadrasana.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="contents topic" id="topicos">
<p class="topic-title first">Tópicos</p>
<ul class="simple">
<li><a class="reference internal" href="#bhadrasana" id="id1">BHADRASANA</a><ul>
<li><a class="reference internal" href="#funcoes" id="id2">Funções</a><ul>
<li><a class="reference internal" href="#module-bhadrasana.bhadrasana.utils.csv_handlers" id="id3">Utilitátios CSV</a></li>
<li><a class="reference internal" href="#module-bhadrasana.bhadrasana.utils.gerente_risco" id="id4">Gerente de Risco</a></li>
<li><a class="reference internal" href="#module-bhadrasana.bhadrasana.utils.gerente_base" id="id5">Gerente de Bases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-bhadrasana.bhadrasana.app" id="id6">Interface</a><ul>
<li><a class="reference internal" href="#modulo-bhadrasana-ajna" id="id7">Módulo Bhadrasana - AJNA</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-bhadrasana.bhadrasana.models.models" id="id8">Banco de Dados</a></li>
</ul>
</li>
</ul>
</div>
<p><a class="reference external" href="index.html">Voltar ao Indice</a></p>
<div class="section" id="bhadrasana">
<h1><a class="toc-backref" href="#id1">BHADRASANA</a><a class="headerlink" href="#bhadrasana" title="Permalink to this headline">¶</a></h1>
<p>Bhadrasana é o módulo que gerencia as informações de diversos sistemas e as
confronta com parâmetros de análise de risco</p>
<div class="section" id="funcoes">
<h2><a class="toc-backref" href="#id2">Funções</a><a class="headerlink" href="#funcoes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-bhadrasana.bhadrasana.utils.csv_handlers">
<span id="utilitatios-csv"></span><h3><a class="toc-backref" href="#id3">Utilitátios CSV</a><a class="headerlink" href="#module-bhadrasana.bhadrasana.utils.csv_handlers" title="Permalink to this headline">¶</a></h3>
<p>Classes para reunir tarefas repetitivas com arquivos csv e planilhas.</p>
<p>Padrão do arquivo csv usado é o mais simples possível:
- Nomes de campo na primeira linha;
- Valores nas restantes;
- Único separador é sempre a vírgula;
- Fim de linha significa nova linha;
- Para comparações, retira espaços antes e depois do conteúdo das colunas.</p>
<dl class="function">
<dt id="bhadrasana.bhadrasana.utils.csv_handlers.muda_titulos_csv">
<code class="descclassname">bhadrasana.bhadrasana.utils.csv_handlers.</code><code class="descname">muda_titulos_csv</code><span class="sig-paren">(</span><em>csv_file</em>, <em>de_para_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/csv_handlers.html#muda_titulos_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.csv_handlers.muda_titulos_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Apenas abre o arquivo e repassa para muda_titulos_lista.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.utils.csv_handlers.muda_titulos_lista">
<code class="descclassname">bhadrasana.bhadrasana.utils.csv_handlers.</code><code class="descname">muda_titulos_lista</code><span class="sig-paren">(</span><em>lista</em>, <em>de_para_dict</em>, <em>make_copy=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/csv_handlers.html#muda_titulos_lista"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.csv_handlers.muda_titulos_lista" title="Permalink to this definition">¶</a></dt>
<dd><p>Muda titulos.</p>
<p>Recebe um dicionário na forma titulo_old:titulo_new
e muda a linha de titulo da lista.</p>
<p>Passar copy=False para listas grandes faz a modificação in-line
na lista original (muito mais rápido) modificando a lista original
e retornando ela mesma. O padrão é copiar a lista e deixar
intocada a lista original</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">plista: lista de listas representando a planilha a ter
títulos modificados</p>
<p>de_para_dict: dicionário titulo_antigo: titulo_novo</p>
<p class="last">copy: Se False, modifica original</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.utils.csv_handlers.retificar_linhas">
<code class="descclassname">bhadrasana.bhadrasana.utils.csv_handlers.</code><code class="descname">retificar_linhas</code><span class="sig-paren">(</span><em>lista</em>, <em>cabecalhos</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/csv_handlers.html#retificar_linhas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.csv_handlers.retificar_linhas" title="Permalink to this definition">¶</a></dt>
<dd><p>Retifica as linhas de arquivos com falhas.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.utils.csv_handlers.sch_processing">
<code class="descclassname">bhadrasana.bhadrasana.utils.csv_handlers.</code><code class="descname">sch_processing</code><span class="sig-paren">(</span><em>path</em>, <em>mask_txt='0.txt'</em>, <em>dest_path='/tmp/tmp1mkljz84'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/csv_handlers.html#sch_processing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.csv_handlers.sch_processing" title="Permalink to this definition">¶</a></dt>
<dd><p>Processa arquivos sch (CARGA).</p>
<p>Processa lotes de extração que gerem arquivos txt csv e arquivos sch
(txt contém os dados e sch descreve o schema), transformando-os em arquivos
csv estilo “planilha”, isto é, primeira linha de cabecalhos.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>path: diretório ou arquivo .zip onde estão os arquivos .sch</dd>
<dt>Obs:</dt>
<dd>Não há procura recursiva, apenas no raiz do diretório</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.utils.csv_handlers.sch_tocsv">
<code class="descclassname">bhadrasana.bhadrasana.utils.csv_handlers.</code><code class="descname">sch_tocsv</code><span class="sig-paren">(</span><em>sch</em>, <em>txt</em>, <em>dest_path='/tmp/tmp1mkljz84'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/csv_handlers.html#sch_tocsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.csv_handlers.sch_tocsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Processa padrão sch (CARGA).</p>
<p>Pega um arquivo txt, aplica os cabecalhos e a informação de um sch,
e o transforma em um csv padrão.</p>
</dd></dl>

</div>
<div class="section" id="module-bhadrasana.bhadrasana.utils.gerente_risco">
<span id="gerente-de-risco"></span><h3><a class="toc-backref" href="#id4">Gerente de Risco</a><a class="headerlink" href="#module-bhadrasana.bhadrasana.utils.gerente_risco" title="Permalink to this headline">¶</a></h3>
<p>Métodos e classes para aplicação de risco (filtros e junções).</p>
<p>Módulo responsável pelas funções que aplicam os filtros/parâmetros
de risco cadastrados nos dados.</p>
<p>Utiliza pandas para realizar filtragem de arquivos csv.
Utiliza MongoDB para arquivar diversos arquivos em base única
e Mongo agreggation framework para consultas.</p>
<dl class="class">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.utils.gerente_risco.</code><code class="descname">GerenteRisco</code><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco" title="Permalink to this definition">¶</a></dt>
<dd><p>Classe que aplica parâmetros de risco e/ou junção em listas.</p>
<p>São fornecidos também metodos para facilitar o de/para entre
o Banco de Dados e arquivos csv de parâmetros, para permitir que
usuário importe e exporte parâmetros de risco.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">pre_processers: dict de funções para pré-processar lista. Função
DEVE esperar uma lista como primeiro parâmetro</p>
<p>pre_processers_params: se houver, será passado para função com mesmo
‘key’ do pre_processer como kargs.</p>
<p>Ex:</p>
<p>gerente.pre_processers[‘mudatitulo’] = muda_titulos</p>
<p>gerente.pre_processers_params[‘mudatitulo’] = {‘de_para_dict’: {}}</p>
<p>Os atributos abaixo NÂO devem ser acessados diretamente. A classe
os gerencia internamente.</p>
<p>riscosativos: dict descreve “riscos” (compilado dos ParametrosRisco)</p>
<p class="last">padraorisco: PadraoRisco ativo</p>
</dd>
</dl>
<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.add_risco">
<code class="descname">add_risco</code><span class="sig-paren">(</span><em>parametrorisco</em>, <em>session=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.add_risco"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.add_risco" title="Permalink to this definition">¶</a></dt>
<dd><p>Configura os parametros de risco ativos.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">parametrorisco: Nome do parâmetro a ser adicionado</p>
<p class="last">session: Sessão do banco de dados</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_juncao">
<code class="descname">aplica_juncao</code><span class="sig-paren">(</span><em>visao</em>, <em>path='/tmp/tmp1mkljz84'</em>, <em>filtrar=False</em>, <em>parametros_ativos=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.aplica_juncao"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_juncao" title="Permalink to this definition">¶</a></dt>
<dd><p>Faz junção de arquivos diversos.</p>
<p>Lê, um a um, os csvs configurados em visao.tabelas. Carrega em
DataFrames e faz merge destes.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">visao: objeto de Banco de Dados que espeficica as configurações
(metadados) da base</p>
<p>path: caminho da base de arquivos csv</p>
<p>filtrar: aplica_risco após merge dos DataFrames</p>
<p class="last">parametros_ativos: subconjunto do parâmetros de risco a serem
aplicados</p>
</dd>
<dt>Returns:</dt>
<dd>Lista contendo os campos filtrados. 1ª linha com nomes de campo.</dd>
<dt>Obs:</dt>
<dd>Quando a base for constituída de arquivo único, utilizar
<a class="reference internal" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_risco" title="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_risco"><code class="xref py py-func docutils literal"><span class="pre">aplica_risco()</span></code></a></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_juncao_mongo">
<code class="descname">aplica_juncao_mongo</code><span class="sig-paren">(</span><em>db</em>, <em>visao</em>, <em>parametros_ativos=None</em>, <em>filtrar=False</em>, <em>pandas=False</em>, <em>limit=100</em>, <em>skip=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.aplica_juncao_mongo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_juncao_mongo" title="Permalink to this definition">¶</a></dt>
<dd><p>Apenas um proxy para compatibilidade reversa.</p>
<p>Proxy para compatibilidade e escolha.
Repassa todos os parâmetros para o método utilizando
pandas se param pandas=True ou aggregate se False.</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_juncao_mongo_aggregate">
<code class="descname">aplica_juncao_mongo_aggregate</code><span class="sig-paren">(</span><em>db</em>, <em>visao</em>, <em>parametros_ativos=None</em>, <em>filtrar=False</em>, <em>limit=100</em>, <em>skip=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.aplica_juncao_mongo_aggregate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_juncao_mongo_aggregate" title="Permalink to this definition">¶</a></dt>
<dd><p>Lê as coleções configuradas no mongo através de aggregates.</p>
<p>Monta um pipeline MongoDB.
Utiliza configurações da visao para montar um aggregate entre coleções
MongoDB. Caso configurado, utiliza as colunas programadas para fazer
‘projection’, isto é, trazer somente estas do Banco. Também aplica
‘match’, filtrando os resultados.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>db: MongoDB
visao: objeto de Banco de Dados que espeficica as configurações
(metadados) da base
parametros_ativos: subconjunto do parâmetros de risco a serem
aplicados
filtrar: aplica_risco na consulta</dd>
<dt>Returns:</dt>
<dd>Lista contendo os campos filtrados. 1ª linha com nomes de campo.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_juncao_mongo_pandas">
<code class="descname">aplica_juncao_mongo_pandas</code><span class="sig-paren">(</span><em>db</em>, <em>visao</em>, <em>parametros_ativos=None</em>, <em>filtrar=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.aplica_juncao_mongo_pandas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_juncao_mongo_pandas" title="Permalink to this definition">¶</a></dt>
<dd><p>Lê as coleções configuradas no mongo.</p>
<p>Lê as coleções, carrega em DataFrames e faz merge destes.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>db: MongoDB
visao: objeto de Banco de Dados que espeficica as configurações
(metadados) da base
parametros_ativos: subconjunto do parâmetros de risco a serem
aplicados
filtrar: aplica_risco após merge dos DataFrames</dd>
<dt>Returns:</dt>
<dd>Lista contendo os campos filtrados. 1ª linha com nomes de campo</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_risco">
<code class="descname">aplica_risco</code><span class="sig-paren">(</span><em>lista=None</em>, <em>arquivo=None</em>, <em>parametros_ativos=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.aplica_risco"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_risco" title="Permalink to this definition">¶</a></dt>
<dd><p>Método de filtragem de lista ou dados de arquivo.</p>
<p>Compara a linha de título da lista recebida com a lista de nomes
de campo que possuem parâmetros de risco ativos. Após, chama para cada
campo encontrado a função de filtragem. Somente um dos parâmetros
precisa ser passado. Caso na lista do pipeline estejam cadastradas
funções de pré-processamento, serão aplicadas.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">lista (list): Lista a ser filtrada, primeira linha deve conter os
nomes dos campos idênticos aos definidos no nome_campo
do parâmetro de risco cadastrado.</p>
<p><strong>OU</strong></p>
<p>arquivo (str): Arquivo csv de onde carregar a lista a ser filtrada</p>
<p class="last">parametros_ativos: subconjunto do parâmetros de risco a serem
aplicados</p>
</dd>
<dt>Returns:</dt>
<dd>Lista contendo os campos filtrados. 1ª linha com nomes de campo</dd>
<dt>Obs:</dt>
<dd>Para um arquivo, quando a base for constituída de vários arquivos,
utilizar <a class="reference internal" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_juncao" title="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.aplica_juncao"><code class="xref py py-func docutils literal"><span class="pre">aplica_juncao()</span></code></a></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.ativa_sanitizacao">
<code class="descname">ativa_sanitizacao</code><span class="sig-paren">(</span><em>norm_function=&lt;function unicode_sanitizar&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.ativa_sanitizacao"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.ativa_sanitizacao" title="Permalink to this definition">¶</a></dt>
<dd><p>Inclui função de sanitização nos pre_processers.</p>
<p>Os pre_processers são usados ao recuperar headers, importar,
aplicar_risco, entre outras ações.</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.checa_depara">
<code class="descname">checa_depara</code><span class="sig-paren">(</span><em>base: bhadrasana.models.models.BaseOrigem</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.checa_depara"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.checa_depara" title="Permalink to this definition">¶</a></dt>
<dd><p>Se tiver depara na base, adiciona aos pre_processers.</p>
<p>Os pre_processers são usados ao recuperar headers, importar,
aplicar_risco, entre outras ações.</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.clear_risco">
<code class="descname">clear_risco</code><span class="sig-paren">(</span><em>session=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.clear_risco"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.clear_risco" title="Permalink to this definition">¶</a></dt>
<dd><p>Zera os parametros de risco ativos.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>session: Sessão do banco de dados</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.cria_padraorisco">
<code class="descname">cria_padraorisco</code><span class="sig-paren">(</span><em>nomepadraorisco</em>, <em>session</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.cria_padraorisco"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.cria_padraorisco" title="Permalink to this definition">¶</a></dt>
<dd><p>Cria um novo objeto PadraoRisco.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">nomepadraorisco: Nome do padrão a ser criado</p>
<p class="last">session: Sessão do banco de dados</p>
</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.csv_to_mongo">
<em class="property">classmethod </em><code class="descname">csv_to_mongo</code><span class="sig-paren">(</span><em>db</em>, <em>base</em>, <em>path=None</em>, <em>arquivo=None</em>, <em>unique=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.csv_to_mongo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.csv_to_mongo" title="Permalink to this definition">¶</a></dt>
<dd><p>Insere conteúdo do arquivo csv em coleção MongoDB.</p>
<p>Lê um arquivo CSV e insere todo seu conteúdo em uma coleção do
MongoDB. Cria a coleção se não existir.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">db: “MongoDBClient” conexão com o banco de dados selecionado</p>
<p>base: Base Origem</p>
<p>path: caminho do(s) arquivo(s) csv</p>
<p><strong>OU</strong></p>
<p>arquivo: caminho e nome do arquivo csv</p>
<p class="last">unique: lista de campos que terão indice único (e
não serão reinseridos) - TODO: unique field on mongo archive</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.get_headers_base">
<code class="descname">get_headers_base</code><span class="sig-paren">(</span><em>baseorigemid</em>, <em>path</em>, <em>csvs=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.get_headers_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.get_headers_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna lista de headers.</p>
<p>Busca última base disponível no diretório de CSVs e
traz todos os headers</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.import_named_csv">
<code class="descname">import_named_csv</code><span class="sig-paren">(</span><em>arquivo</em>, <em>session=None</em>, <em>padraorisco=None</em>, <em>filtro=&lt;Filtro.igual: 1&gt;</em>, <em>tolist=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.import_named_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.import_named_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Importa vários parâmetros nomeados de um arquivo único.</p>
<p>Abre um arquivo csv, cada coluna sendo um filtro.
A primeira linha contém o campo a ser filtrado e as linhas
seguintes os valores do filtro. Cria filtros na memória, e no
Banco de Dados caso session seja informada.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">arquivo: Nome e caminho do arquivo .csv</p>
<p>session: sessão ativa com BD</p>
<p class="last">filtro: Tipo de filtro a ser assumido como padrão</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.importa_base">
<code class="descname">importa_base</code><span class="sig-paren">(</span><em>csv_folder: str</em>, <em>baseid: int</em>, <em>data</em>, <em>filename: str</em>, <em>remove=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.importa_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.importa_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Copia base para dest_path, processando se necessário.</p>
<p>Aceita arquivos .zip contendo arquivos sch e arquivos csv únicos.
No caso de CSV, retorna erro caso títulos não batam com importação
anterior para a mesma “BASE” (dest_path) para evitar erros do usuário</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">csv_folder: destino do(s) arquivo(s) gerados</p>
<p>base_id: id da base, será usada para identificar uma subpasta</p>
<p>data: data do período inicial da base/extração. Será usada
para gerar subpasta no formato YYYY/MM/DD</p>
<p>filename: caminho completo do arquivo da base de origem
(fonte externa/extração)</p>
<p class="last">remove: excluir o arquivo temporário após processamento</p>
</dd>
<dt>Returns:</dt>
<dd>Uma tupla ou lista de tuplas. Primeiros itens são CSVs criados</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.load_csv">
<code class="descname">load_csv</code><span class="sig-paren">(</span><em>arquivo</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.load_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.load_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Carrega arquivo csv em lista.</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.load_mongo">
<code class="descname">load_mongo</code><span class="sig-paren">(</span><em>db</em>, <em>base=None</em>, <em>collection_name=None</em>, <em>parametros_ativos=None</em>, <em>limit=0</em>, <em>skip=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.load_mongo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.load_mongo" title="Permalink to this definition">¶</a></dt>
<dd><p>Recupera da base mongodb em um lista.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">db: “MongoDBClient” conexão com o banco de dados selecionado.</p>
<p>base: Base Origem</p>
<p><strong>OU</strong></p>
<p>collection_name: nome da coleção do MongoDB</p>
<p class="last">parametros_ativos: subconjunto do parâmetros de risco a serem
aplicados</p>
</dd>
<dt>Returns:</dt>
<dd>Lista contendo os campos filtrados. 1ª linha com nomes de campo</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.parametro_tocsv">
<code class="descname">parametro_tocsv</code><span class="sig-paren">(</span><em>campo</em>, <em>path='/tmp/tmp1mkljz84'</em>, <em>dbsession=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.parametro_tocsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.parametro_tocsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Salva parametro em arquivo.</p>
<p>Salva os valores do parâmetro de risco em um arquivo csv
no formato ‘valor’, ‘tipo_filtro’.</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.parametros_fromcsv">
<code class="descname">parametros_fromcsv</code><span class="sig-paren">(</span><em>campo</em>, <em>session=None</em>, <em>padraorisco=None</em>, <em>lista=None</em>, <em>path='/tmp/tmp1mkljz84'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.parametros_fromcsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.parametros_fromcsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Carrega parâmetros de risco de um aquivo ou de uma lista.</p>
<p>Abre um arquivo csv, recupera parâmetros configurados nele,
adiciona à configuração do gerente e <strong>também adiciona ao Banco de
Dados ativo</strong> caso não existam nele ainda. Para isso é preciso
passar a session como parâmetro, senão cria apenas na memória
Pode receber uma lista no lugar de um arquivo csv (como implementado
em import_named_csv).</p>
<p>Ver também:</p>
<p><a class="reference internal" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.parametros_tocsv" title="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.parametros_tocsv"><code class="xref py py-func docutils literal"><span class="pre">parametros_tocsv()</span></code></a>
<a class="reference internal" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.import_named_csv" title="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.import_named_csv"><code class="xref py py-func docutils literal"><span class="pre">import_named_csv()</span></code></a></p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">campo: nome do campo a ser filtrado e deve ser também
o nome do arquivo .csv</p>
<p>session: a sessão com o banco de dados</p>
<p>lista: passar uma lista pré-prenchida para usar a função com outros
tipos de fontes/arquivos. Se passada uma lista, função não
abrirá arquivo .csv, usará os valores da função</p>
<p><em>OU</em></p>
<p class="last">path: caminho do arquivo .csv</p>
</dd>
<dt>Obs:</dt>
<dd>O arquivo .csv ou a lista DEVEM estar no formato valor, tipo_filtro</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.parametros_tocsv">
<code class="descname">parametros_tocsv</code><span class="sig-paren">(</span><em>path='/tmp/tmp1mkljz84'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.parametros_tocsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.parametros_tocsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Salva os parâmetros adicionados a um gerente em um arquivo csv.</p>
<p>Ver também: <a class="reference internal" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.parametros_fromcsv" title="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.parametros_fromcsv"><code class="xref py py-func docutils literal"><span class="pre">parametros_fromcsv()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.pre_processa">
<code class="descname">pre_processa</code><span class="sig-paren">(</span><em>lista</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.pre_processa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.pre_processa" title="Permalink to this definition">¶</a></dt>
<dd><p>Aplica funções de processamento de texto na lista.</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.pre_processa_arquivos">
<code class="descname">pre_processa_arquivos</code><span class="sig-paren">(</span><em>lista_arquivos</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.pre_processa_arquivos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.pre_processa_arquivos" title="Permalink to this definition">¶</a></dt>
<dd><p>Carrega uma lista de arquivos e pré processa texto.</p>
<p>Carrega a lista de arquivos aplica as funções de pré processamento
ativas. Salva novamente no mesmo arquivo.</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.remove_risco">
<code class="descname">remove_risco</code><span class="sig-paren">(</span><em>parametrorisco</em>, <em>session=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.remove_risco"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.remove_risco" title="Permalink to this definition">¶</a></dt>
<dd><p>Configura os parametros de risco ativos.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">parametrorisco: Nome do parâmetro a ser removido</p>
<p class="last">session: Sessão do banco de dados</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.save_csv">
<code class="descname">save_csv</code><span class="sig-paren">(</span><em>lista</em>, <em>arquivo</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.save_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.save_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Salva lista em arquivo csv. Exclui se existir.</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.set_padraorisco">
<code class="descname">set_padraorisco</code><span class="sig-paren">(</span><em>padraorisco</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.set_padraorisco"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.set_padraorisco" title="Permalink to this definition">¶</a></dt>
<dd><p>Vincula o Gerente a um objeto padraoriscoOriginal.</p>
<p>Atenção: <strong>Todos</strong> os parâmetros de risco ativos no Gerente serão
zerados!!!</p>
<p><strong>Todos</strong> os parâmetros de risco vinculados à padraoriscoOriginal serão
adicionados aos riscos ativos!!!</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.strip_lines">
<code class="descname">strip_lines</code><span class="sig-paren">(</span><em>lista</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#GerenteRisco.strip_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.GerenteRisco.strip_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Retira espaços adicionais entre palavras.</p>
<p>Precaução: retirar espaços mortos de todo item
da lista para evitar erros de comparação</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.SemHeaders">
<em class="property">exception </em><code class="descclassname">bhadrasana.bhadrasana.utils.gerente_risco.</code><code class="descname">SemHeaders</code><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#SemHeaders"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.SemHeaders" title="Permalink to this definition">¶</a></dt>
<dd><p>Exceção personalizada.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.contains">
<code class="descclassname">bhadrasana.bhadrasana.utils.gerente_risco.</code><code class="descname">contains</code><span class="sig-paren">(</span><em>listaoriginal</em>, <em>nomecampo</em>, <em>listavalores</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#contains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Realiza a filtragem dos riscos nas listas.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">listaoriginal: Lista importada do CSV</p>
<p>nomecampo: Nome do campo a ser buscado</p>
<p class="last">listavalores: Lista de valores a serem buscados</p>
</dd>
<dt>Returns:</dt>
<dd>Retorna uma lista com itens da listaoriginal que contenham os itens
da listavalores</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.equality">
<code class="descclassname">bhadrasana.bhadrasana.utils.gerente_risco.</code><code class="descname">equality</code><span class="sig-paren">(</span><em>listaoriginal</em>, <em>nomecampo</em>, <em>listavalores</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#equality"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.equality" title="Permalink to this definition">¶</a></dt>
<dd><p>Realiza a filtragem dos riscos nas listas.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">listaoriginal: Lista importada do CSV</p>
<p>nomecampo: Nome do campo a ser buscado</p>
<p class="last">listavalores: Lista de valores a serem buscados</p>
</dd>
<dt>Returns:</dt>
<dd>Retorna uma lista com itens da listaoriginal que são iguais ao da
listavalores</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.utils.gerente_risco.startswith">
<code class="descclassname">bhadrasana.bhadrasana.utils.gerente_risco.</code><code class="descname">startswith</code><span class="sig-paren">(</span><em>listaoriginal</em>, <em>nomecampo</em>, <em>listavalores</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_risco.html#startswith"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_risco.startswith" title="Permalink to this definition">¶</a></dt>
<dd><p>Realiza a filtragem dos riscos nas listas.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">listaoriginal: Lista importada do CSV</p>
<p>nomecampo: Nome do campo a ser buscado</p>
<p class="last">listavalores: Lista de valores a serem buscados</p>
</dd>
<dt>Returns:</dt>
<dd>Retorna uma lista com itens da listaoriginal que começam com os itens
da listavalores</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-bhadrasana.bhadrasana.utils.gerente_base">
<span id="gerente-de-bases"></span><h3><a class="toc-backref" href="#id5">Gerente de Bases</a><a class="headerlink" href="#module-bhadrasana.bhadrasana.utils.gerente_base" title="Permalink to this headline">¶</a></h3>
<p>Inspeciona uma Base SQL Alchemy.</p>
<p>GerenteBase abstrai a necessidade de conhecer a estrutura das bases
ou utilizar comandos mais avançados.</p>
<p>Transforma a estrutura em dicts mais fáceis de lidar.</p>
<p>Usa reflection para navegar nos modelos.</p>
<dl class="class">
<dt id="bhadrasana.bhadrasana.utils.gerente_base.Filtro">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.utils.gerente_base.</code><code class="descname">Filtro</code><span class="sig-paren">(</span><em>field</em>, <em>tipo</em>, <em>valor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_base.html#Filtro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_base.Filtro" title="Permalink to this definition">¶</a></dt>
<dd><p>Estrutura de filtro.</p>
</dd></dl>

<dl class="class">
<dt id="bhadrasana.bhadrasana.utils.gerente_base.GerenteBase">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.utils.gerente_base.</code><code class="descname">GerenteBase</code><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_base.html#GerenteBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_base.GerenteBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Inspecionar e tratar models SQLAlchemy.</p>
<p>Métodos para padronizar a manipulação de bases de dados
no modelo do sistema bhadrasana</p>
<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.filtra">
<code class="descname">filtra</code><span class="sig-paren">(</span><em>base</em>, <em>filters</em>, <em>return_query=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_base.html#GerenteBase.filtra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.filtra" title="Permalink to this definition">¶</a></dt>
<dd><p>Aplica os filtros selecionados na base.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">base: base a ser filtrada</p>
<p>filters: parâmetros de filtro selecionados</p>
<p class="last">return_query: se True retorna a query executada</p>
</dd>
<dt>Returns:</dt>
<dd>Lista com os resultados da filtragem.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.get_paiarvore">
<code class="descname">get_paiarvore</code><span class="sig-paren">(</span><em>ainstance</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_base.html#GerenteBase.get_paiarvore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.get_paiarvore" title="Permalink to this definition">¶</a></dt>
<dd><p>Navega estrutura SQLAlchemy.</p>
<p>Recursivamente retorna o pai da instância de objecto,
até chegar ao ‘pai de todos/pai da árvore’.</p>
</dd></dl>

<dl class="attribute">
<dt id="bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.list_models">
<code class="descname">list_models</code><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.list_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna lista de modelos ativos.</p>
</dd></dl>

<dl class="attribute">
<dt id="bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.list_modulos">
<code class="descname">list_modulos</code><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.list_modulos" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna módulos de modelo no caminho configurado.</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.recursive_tree">
<code class="descname">recursive_tree</code><span class="sig-paren">(</span><em>ainstance</em>, <em>recursive=True</em>, <em>child=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_base.html#GerenteBase.recursive_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.recursive_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursivamente percorre “filhos” da instância.</p>
<p>Retorna uma árvore HTML.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">ainstance: objeto que é nó primário da árvore</p>
<p>recursive: se True, apenas lista filhos diretos,
para expandir se necessário</p>
<p class="last">child: se anteriormente utilizado get_paiarvore, filho é a
instância original. Apenas para destacá-lo.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.set_module">
<code class="descname">set_module</code><span class="sig-paren">(</span><em>model</em>, <em>db=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_base.html#GerenteBase.set_module"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.set_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Lê a estrutura de ‘tabelas’ de um módulo SQLAlchemy.</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.set_path">
<code class="descname">set_path</code><span class="sig-paren">(</span><em>path</em>, <em>test=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_base.html#GerenteBase.set_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.set_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Lê a estrutura de ‘tabelas’ de uma pasta de csvs importados.</p>
</dd></dl>

<dl class="method">
<dt id="bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.set_session">
<code class="descname">set_session</code><span class="sig-paren">(</span><em>adbsession</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/utils/gerente_base.html#GerenteBase.set_session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.utils.gerente_base.GerenteBase.set_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Recebe conexão.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-bhadrasana.bhadrasana.app">
<span id="interface"></span><h2><a class="toc-backref" href="#id6">Interface</a><a class="headerlink" href="#module-bhadrasana.bhadrasana.app" title="Permalink to this headline">¶</a></h2>
<p>Bhadrasana.</p>
<div class="section" id="modulo-bhadrasana-ajna">
<h3><a class="toc-backref" href="#id7">Módulo Bhadrasana - AJNA</a><a class="headerlink" href="#modulo-bhadrasana-ajna" title="Permalink to this headline">¶</a></h3>
<div class="section" id="interface-do-usuario-web">
<h4>Interface do Usuário - WEB<a class="headerlink" href="#interface-do-usuario-web" title="Permalink to this headline">¶</a></h4>
<p>Módulo responsável por gerenciar bases de dados importadas/acessadas pelo AJNA,
administrando estas e as cruzando com parâmetros de risco.</p>
<p>Serve para a administração, pré-tratamento e visualização dos dados importados,
assim como para acompanhamento de registros de log e detecção de problemas nas
conexões internas.</p>
<p>Adicionalmente, permite o merge entre bases, navegação de bases, e
a aplicação de filtros/parâmetros de risco.</p>
<dl class="function">
<dt id="bhadrasana.bhadrasana.app.adiciona_base">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">adiciona_base</code><span class="sig-paren">(</span><em>nome</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#adiciona_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.adiciona_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Cria nova instância de Base Origem com o nome passado.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.adiciona_coluna">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">adiciona_coluna</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#adiciona_coluna"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.adiciona_coluna" title="Permalink to this definition">¶</a></dt>
<dd><p>Função inserir uma coluna ao objeto Visão.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">visaoid: ID do objeto de Banco de Dados que espeficica as
configurações (metadados) da base</p>
<p class="last">col_nova: Nome da coluna que será inserida no objeto Visão</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.adiciona_depara">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">adiciona_depara</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#adiciona_depara"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.adiciona_depara" title="Permalink to this definition">¶</a></dt>
<dd><p>De_para - troca títulos.</p>
<p>Função que permite unificar o nome de colunas que possuem o mesmo
conteúdo.</p>
<p>Esta função realiza a troca do titulo de uma coluna por outro, permitindo
que duas colunas que tragam a mesma informação em bases diferentes sejam
filtradas por um único parâmetro de risco.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">baseid: ID da Base de Origem do arquivo</p>
<p>titulo_antigo: Titulo original da base a ser importada</p>
<p class="last">titulo_novo: Titulo unificado</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.adiciona_filtro">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">adiciona_filtro</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#adiciona_filtro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.adiciona_filtro" title="Permalink to this definition">¶</a></dt>
<dd><p>Incluir Filtro. Deprecated.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.adiciona_padrao">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">adiciona_padrao</code><span class="sig-paren">(</span><em>nome</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#adiciona_padrao"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.adiciona_padrao" title="Permalink to this definition">¶</a></dt>
<dd><p>Função que adiciona um novo padrão de riscos.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>nome: Nome do padrão a ser inserido no Banco de Dados</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.adiciona_parametro">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">adiciona_parametro</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#adiciona_parametro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.adiciona_parametro" title="Permalink to this definition">¶</a></dt>
<dd><p>Função que adiciona um novo parâmetro de risco.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">padraoid: ID do padrão de risco</p>
<p>risco_novo: Nome do novo parâmetro</p>
<p class="last">lista: Lista com os nomes dos novos parâmetros</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.adiciona_tabela">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">adiciona_tabela</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#adiciona_tabela"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.adiciona_tabela" title="Permalink to this definition">¶</a></dt>
<dd><p>Função para inserir uma tabela ao objeto Visão.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">visaoid: ID do objeto de Banco de Dados que espeficica as
configurações (metadados) da base</p>
<p>csv: Nome do CSV a ser inserido</p>
<p>primario:</p>
<p class="last">estrangeiro:</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.adiciona_valor">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">adiciona_valor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#adiciona_valor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.adiciona_valor" title="Permalink to this definition">¶</a></dt>
<dd><p>Função que adiciona um novo valor ao parâmetro de risco selecionado.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">padraoid: ID do padrão de risco</p>
<p>novo_valor: Nome do valor a ser inserido no parâmetro</p>
<p class="last">tipo_filtro: Filtro que este valor deverá ser buscado nas bases</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.adiciona_visao">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">adiciona_visao</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#adiciona_visao"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.adiciona_visao" title="Permalink to this definition">¶</a></dt>
<dd><p>Função que permite a criação de um novo objeto Visão.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">baseid: ID da Base de Origem do arquivo</p>
<p class="last">visao_novo: Nome do objeto de Banco de Dados que espeficica as
configurações (metadados) da base</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.allowed_file">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">allowed_file</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#allowed_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.allowed_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Checa extensões permitidas.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.arvore">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">arvore</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#arvore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.arvore" title="Permalink to this definition">¶</a></dt>
<dd><p>Àrvore GerenteBase. Deprecated.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.arvore_teste">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">arvore_teste</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#arvore_teste"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.arvore_teste" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.consulta_bases_executar">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">consulta_bases_executar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#consulta_bases_executar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.consulta_bases_executar" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.edita_depara">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">edita_depara</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#edita_depara"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.edita_depara" title="Permalink to this definition">¶</a></dt>
<dd><p>Tela para configurar os titulos das bases a serem importadas.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">baseid: ID da Base de Origem do arquivo</p>
<p class="last">padraoid: ID do padrão de risco</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.edita_risco">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">edita_risco</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#edita_risco"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.edita_risco" title="Permalink to this definition">¶</a></dt>
<dd><p>Editar Padrões e Valores de Risco.</p>
<p>Tela para configurar os parâmetros de risco das bases importadas,
permite a alteração e criação de novos parâmetros e seus dados.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">padraoid: ID do padrão de risco criado e/ou escolhido para
realizar a alteração</p>
<p class="last">riscoid: ID do objeto de risco para aplicar a edição</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.exclui_coluna">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">exclui_coluna</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#exclui_coluna"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.exclui_coluna" title="Permalink to this definition">¶</a></dt>
<dd><p>Função que permite a remoção de uma coluna do objeto Visão.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">visaoid: ID do objeto de Banco de Dados que espeficica as
configurações (metadados) da base</p>
<p class="last">colunaid: ID da coluna a ser excluída</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.exclui_depara">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">exclui_depara</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#exclui_depara"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.exclui_depara" title="Permalink to this definition">¶</a></dt>
<dd><p>Função que remove a troca de titulo selecionada.</p>
<p>Esta função permite unificar o nome de colunas que possuem o mesmo
conteúdo.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">baseid: ID da Base de Origem do arquivo</p>
<p class="last">tituloid: ID do titulo a ser excluído</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.exclui_filtro">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">exclui_filtro</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#exclui_filtro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.exclui_filtro" title="Permalink to this definition">¶</a></dt>
<dd><p>Excluir Filtro. Deprecated.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.exclui_parametro">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">exclui_parametro</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#exclui_parametro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.exclui_parametro" title="Permalink to this definition">¶</a></dt>
<dd><p>Função que exclui um parâmetro de risco e seus respectivos valores.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">padraoid: ID do padrão de risco</p>
<p class="last">riscoid: Nome do parâmetro a ser excluído</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.exclui_tabela">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">exclui_tabela</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#exclui_tabela"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.exclui_tabela" title="Permalink to this definition">¶</a></dt>
<dd><p>Função para remover uma tabela do objeto Visão.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">visaoid: ID do objeto de Banco de Dados que espeficica as
configurações (metadados) da base</p>
<p class="last">tabelaid: ID da tabela a ser excluída</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.exclui_valor">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">exclui_valor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#exclui_valor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.exclui_valor" title="Permalink to this definition">¶</a></dt>
<dd><p>Ecluir uma instância de ValorParametro.</p>
<p>Função que exclui apenas o valor e o tipo_filtro de um parâmetro de
risco.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">padraoid: ID do padrão de risco</p>
<p>riscoid: ID do parâmetro de risco</p>
<p class="last">valorid: ID do valor a ser excluído</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.exclui_visao">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">exclui_visao</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#exclui_visao"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.exclui_visao" title="Permalink to this definition">¶</a></dt>
<dd><p>Função que permite a remoção de um objeto Visão.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>visaoid: ID do objeto de Banco de Dados que espeficica as
configurações (metadados) da base</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.exporta_csv">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">exporta_csv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#exporta_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.exporta_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Grava em arquivo parâmetros ativos.</p>
<p>Função que cria um arquivo CSV contendo duas colunas(valor e tipo_filtro)
e realiza a exportação dos dados do parâmetro de risco selecionado.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">padraoid: ID do padrão de risco</p>
<p class="last">riscoid: ID do parâmetro de risco</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.importa_base">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">importa_base</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#importa_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.importa_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Função para upload do arquivo de uma extração ou outra fonte externa.</p>
<p>Utiliza o :class: <cite>bhadrasana.utils.gerenterisco.GerenteRisco</cite>.
Suporte por ora para csv com títulos e zip com sch (padrão Carga)
Necessita um Servidor Celery para repassar responsabilidade.
Ver também :func: <cite>bhadrasana.workers.tasks.importar_base</cite></p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">baseid: ID da Base de Origem do arquivo</p>
<p>data: data inicial do período extraído (se não for passada,
assume hoje)</p>
<p class="last">file: arquivo csv, sch+txt, ou conjunto deles em formato zip</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.importa_csv">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">importa_csv</code><span class="sig-paren">(</span><em>padraoid</em>, <em>riscoid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#importa_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.importa_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Importar arquivo.</p>
<p>Função que lê um arquivo csv contendo duas colunas(valor e tipo_filtro)
e realiza a importação dos dados para um parâmetro de risco selecionado.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">padraoid: ID do padrão de risco</p>
<p class="last">riscoid: ID do parâmetro de risco</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.index">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">index</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.index" title="Permalink to this definition">¶</a></dt>
<dd><p>View retorna index.html ou login se não autenticado.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.juncoes">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">juncoes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#juncoes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.juncoes" title="Permalink to this definition">¶</a></dt>
<dd><p>Tela para cadastramento de junções.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">baseid: ID da Base de Origem do arquivo</p>
<p class="last">visaoid: ID objeto de Banco de Dados que espeficica as configurações
(metadados) da base</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.log_every_request">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">log_every_request</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#log_every_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.log_every_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Envia cada requisição ao log.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.mynavbar">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">mynavbar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#mynavbar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.mynavbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Menu da aplicação.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.navega_bases">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">navega_bases</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#navega_bases"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.navega_bases" title="Permalink to this definition">¶</a></dt>
<dd><p>Navega Bases. Deprecated.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.risco">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">risco</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#risco"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.risco" title="Permalink to this definition">¶</a></dt>
<dd><p>Função para aplicar parâmetros de risco em arquivo(s) importados.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">baseid: ID da Base de Origem do arquivo</p>
<p>padraoid: ID do padrão de risco aplicável</p>
<p>visaoid: ID do objeto Visao (junção de CSVs e seleção de campos)</p>
<p>file: caminho do(s) csv(s) já processados e no diretório</p>
<dl class="last docutils">
<dt>acao:</dt>
<dd>‘aplicar’ - aplica_risco no diretório file
‘arquivar’ - adiciona diretório ao BD e apaga dir
‘excluir’ - apaga dir
‘mongo’ - busca no banco de dados arquivado</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.task_progress">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">task_progress</code><span class="sig-paren">(</span><em>taskid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#task_progress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.task_progress" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna um json do progresso da celery task.</p>
</dd></dl>

<dl class="function">
<dt id="bhadrasana.bhadrasana.app.valores">
<code class="descclassname">bhadrasana.bhadrasana.app.</code><code class="descname">valores</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/app.html#valores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.app.valores" title="Permalink to this definition">¶</a></dt>
<dd><p>Função que busca os valores dos parâmetros cadastrados.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>parametroid: ID do parâmetro de risco a ser buscado</dd>
<dt>Returns:</dt>
<dd>Lista com os valores e seus respectivos filtros de busca</dd>
</dl>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="module-bhadrasana.bhadrasana.models.models">
<span id="banco-de-dados"></span><h2><a class="toc-backref" href="#id8">Banco de Dados</a><a class="headerlink" href="#module-bhadrasana.bhadrasana.models.models" title="Permalink to this headline">¶</a></h2>
<p>Modelo de dados necessário para app bhadrasana.</p>
<dl class="class">
<dt id="bhadrasana.bhadrasana.models.models.BaseOrigem">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.models.models.</code><code class="descname">BaseOrigem</code><span class="sig-paren">(</span><em>nome</em>, <em>caminho=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#BaseOrigem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.BaseOrigem" title="Permalink to this definition">¶</a></dt>
<dd><p>Metadado sobre as bases de dados disponíveis/integradas.</p>
<p>Caminho: caminho no disco onde os dados da importação da base
(normalmente arquivos csv) estão guardados</p>
</dd></dl>

<dl class="class">
<dt id="bhadrasana.bhadrasana.models.models.Coluna">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.models.models.</code><code class="descname">Coluna</code><span class="sig-paren">(</span><em>csv</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#Coluna"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.Coluna" title="Permalink to this definition">¶</a></dt>
<dd><p>Metadado sobre os csvs capturados.</p>
<p>Define os campos que serão exibidos na junção.
Ver <code class="xref py py-func docutils literal"><span class="pre">gerente_risco.aplica_juncao()</span></code></p>
</dd></dl>

<dl class="class">
<dt id="bhadrasana.bhadrasana.models.models.DePara">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.models.models.</code><code class="descname">DePara</code><span class="sig-paren">(</span><em>titulo_ant</em>, <em>titulo_novo</em>, <em>base</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#DePara"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.DePara" title="Permalink to this definition">¶</a></dt>
<dd><p>Renomeia os titulos das colunas ao importar uma base.</p>
</dd></dl>

<dl class="class">
<dt id="bhadrasana.bhadrasana.models.models.Filtro">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.models.models.</code><code class="descname">Filtro</code><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#Filtro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.Filtro" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumerado.</p>
<p>Para escolha do tipo de filtro a ser
aplicado no parâmetro de risco</p>
</dd></dl>

<dl class="class">
<dt id="bhadrasana.bhadrasana.models.models.MySession">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.models.models.</code><code class="descname">MySession</code><span class="sig-paren">(</span><em>base</em>, <em>test=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#MySession"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.MySession" title="Permalink to this definition">¶</a></dt>
<dd><p>Sessão com BD.</p>
<p>Para definir a sessão com o BD na aplicação. Para os
testes, passando o parâmetro test=True, um BD na memória</p>
<dl class="attribute">
<dt id="bhadrasana.bhadrasana.models.models.MySession.engine">
<code class="descname">engine</code><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.MySession.engine" title="Permalink to this definition">¶</a></dt>
<dd><p>Engine.</p>
</dd></dl>

<dl class="attribute">
<dt id="bhadrasana.bhadrasana.models.models.MySession.session">
<code class="descname">session</code><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.MySession.session" title="Permalink to this definition">¶</a></dt>
<dd><p>Session.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="bhadrasana.bhadrasana.models.models.PadraoRisco">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.models.models.</code><code class="descname">PadraoRisco</code><span class="sig-paren">(</span><em>nome</em>, <em>base=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#PadraoRisco"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.PadraoRisco" title="Permalink to this definition">¶</a></dt>
<dd><p>Metadado sobre as bases de dados disponíveis/integradas.</p>
<p>Caminho: caminho no disco onde os dados da importação da base
(normalmente arquivos csv) estão guardados</p>
</dd></dl>

<dl class="class">
<dt id="bhadrasana.bhadrasana.models.models.ParametroRisco">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.models.models.</code><code class="descname">ParametroRisco</code><span class="sig-paren">(</span><em>nome</em>, <em>descricao=''</em>, <em>padraorisco=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#ParametroRisco"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.ParametroRisco" title="Permalink to this definition">¶</a></dt>
<dd><p>Paramêtro de Risco.</p>
<p>Nomeia um parâmetro de risco que pode ser aplicado
como filtro em um Banco de Dados. Um parâmetro tem uma
lista de valores que serão o filtro efetivo.</p>
</dd></dl>

<dl class="class">
<dt id="bhadrasana.bhadrasana.models.models.SQLDBUser">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.models.models.</code><code class="descname">SQLDBUser</code><span class="sig-paren">(</span><em>username</em>, <em>password</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#SQLDBUser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.SQLDBUser" title="Permalink to this definition">¶</a></dt>
<dd><p>Base de Usuários.</p>
<dl class="classmethod">
<dt id="bhadrasana.bhadrasana.models.models.SQLDBUser.encript">
<em class="property">classmethod </em><code class="descname">encript</code><span class="sig-paren">(</span><em>password</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#SQLDBUser.encript"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.SQLDBUser.encript" title="Permalink to this definition">¶</a></dt>
<dd><p>Recebe uma senha em texto plano, retorna uma versão encriptada.</p>
</dd></dl>

<dl class="classmethod">
<dt id="bhadrasana.bhadrasana.models.models.SQLDBUser.get">
<em class="property">classmethod </em><code class="descname">get</code><span class="sig-paren">(</span><em>session</em>, <em>username</em>, <em>password=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#SQLDBUser.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.SQLDBUser.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Testa se usuário existe, e se passado, se a senha está correta.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>SQLDBUser ou None</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="bhadrasana.bhadrasana.models.models.Tabela">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.models.models.</code><code class="descname">Tabela</code><span class="sig-paren">(</span><em>csv</em>, <em>primario</em>, <em>estrangeiro</em>, <em>pai_id</em>, <em>visao_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#Tabela"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.Tabela" title="Permalink to this definition">¶</a></dt>
<dd><p>Metadado sobre os csvs capturados.</p>
<p>Para mapear relações entre os
csvs capturados e permitir junção automática se necessário.
Utilizado por “GerenteRisco.aplica_juncao()”
Ver <code class="xref py py-func docutils literal"><span class="pre">gerente_risco.aplica_juncao()</span></code></p>
<dl class="attribute">
<dt id="bhadrasana.bhadrasana.models.models.Tabela.csv_file">
<code class="descname">csv_file</code><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.Tabela.csv_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Acesso ao campo csv. Inclui extensão.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="bhadrasana.bhadrasana.models.models.ValorParametro">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.models.models.</code><code class="descname">ValorParametro</code><span class="sig-paren">(</span><em>nome</em>, <em>tipo</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#ValorParametro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.ValorParametro" title="Permalink to this definition">¶</a></dt>
<dd><p>Um valor de parametro.</p>
<p>A ser aplicado como filtro em uma fonte de dados.</p>
<p>nomecampo = nome do campo da fonte de dados a ser aplicado filtro</p>
<p>tipofiltro = tipo de função de filtragem a ser realizada
(ver enum TipoFiltro)</p>
</dd></dl>

<dl class="class">
<dt id="bhadrasana.bhadrasana.models.models.Visao">
<em class="property">class </em><code class="descclassname">bhadrasana.bhadrasana.models.models.</code><code class="descname">Visao</code><span class="sig-paren">(</span><em>csv</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bhadrasana/bhadrasana/models/models.html#Visao"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bhadrasana.bhadrasana.models.models.Visao" title="Permalink to this definition">¶</a></dt>
<dd><p>Metadado sobre os csvs capturados.</p>
<p>Para mapear relações entre os
csvs capturados e permitir junção automática se necessário.
Utilizado por “GerenteRisco.aplica_juncao()”
Ver <code class="xref py py-func docutils literal"><span class="pre">gerente_risco.aplica_juncao()</span></code></p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="virasana.html" class="btn btn-neutral float-right" title="VIRASANA" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ajna_commons.html" class="btn btn-neutral" title="COMMONS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, RFB.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1a',
            LANGUAGE:'pt-BR',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>